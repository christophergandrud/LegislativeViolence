# Slim data set
TVSimEC <- TVSimEC[, c("ID", "Time", "HRCC", "Fitted")]
# Remove values outside of the 2.5% and 97.5% quantiles
# Find 2.5% and 97.5% quantiles for HRCC
TVSimPercEC <- ddply(TVSimEC, .(Time), transform, Lower = HRCC < quantile(HRCC, c(0.025)))
TVSimPercEC <- ddply(TVSimPercEC, .(Time), transform, Upper = HRCC > quantile(HRCC, c(0.975)))
# Remove variables outside of the middle 95%
TVSimPercEC <- subset(TVSimPercEC, Lower == FALSE & Upper == FALSE)
#### Append data sets ####
Graphable <- rbind(TVSimPercECLBC, TVSimPercEC)
# Order Variables
Graphable <- Graphable[order(Graphable$Time), ]
Graphable <- Graphable[order(Graphable$ID), ]
#### Graph Simulated Combined Hazard Ratios ####
# Create colour scale
ColourScale <- c("#1B9E77", "#E7298A")
# Plot
ggplot(Graphable, aes(x = Time, y = HRCC, colour = Fitted)) +
geom_point(shape = 21, alpha = I(0.06), size = 5) +
geom_smooth(method = "gam") +
scale_colour_manual(values = ColourScale, name = "") +
geom_hline(aes(yintercept = 1), linetype = "dotted", ) +
scale_y_continuous(limits = c(0, 4)) +
scale_x_continuous(breaks = c(0, 94), labels = c(1821, 2008)) +
xlab("") + ylab("Simulated Relative Hazard\n") +
theme_bw(base_size = 15)
#### Append data sets ####
Graphable <- rbind(TVSimPercECLBC, TVSimPercEC)
# Order Variables
Graphable <- Graphable[order(Graphable$Time), ]
Graphable <- Graphable[order(Graphable$ID), ]
#### Graph Simulated Combined Hazard Ratios ####
# Create colour scale
ColourScale <- c("#1B9E77", "#E7298A")
# Plot
ggplot(Graphable, aes(x = Time, y = HRCC, colour = Fitted)) +
geom_point(shape = 21, alpha = I(0.06), size = 5) +
geom_smooth(method = "gam") +
scale_colour_manual(values = ColourScale, name = "") +
geom_hline(aes(yintercept = 1), linetype = "dotted", ) +
scale_y_continuous(limits = c(0, 4)) +
scale_x_continuous(breaks = c(0, 94), labels = c(1821, 2008)) +
xlab("") + ylab("Simulated Relative Hazard\n") +
theme_bw(base_size = 15)
# Set working directory
# Load required libraries
library(survival)
library(MSBVAR)
library(reshape)
library(reshape2)
library(ggplot2)
#Load Data
data1 <- read.csv("~/Desktop/JeffFall2012/jeffData.csv")
# Create  interactions
data1$ED_TVC <- data1$executive_dom_fall * data1$end
# Sort Countries
data1 <- data1[order(data1$country), ]
# Run Cox PH Model
coxed_F <- coxph(Surv(begin, end, Partisan_Spell) ~ ED_TVC + lbc*executive_dom_fall + cumulative_crisis + polity2 + lgrow + periphery_LAm ++  frailty(imfcode, dist="gamma", sparse=TRUE, theta=FALSE), data=data1, control=coxph.control(eps=1e-09, iter.max=100, outer.max=100))
summary(coxed_F)
# Create coefficient matrix
Coef <- matrix(coxed_F$coefficients)
# Create variance-covariance matrix
VC <- vcov(coxed_F)
#### Simulate Using MSBVAR ####
Drawn <- rmultnorm(n = 1000, mu = Coef, vmat = VC)
# Keep qmv and Lqmv
Drawn <- data.frame(Drawn[, c(1, 2, 3, 8)])
# Create Merge Variable (Simulation Number)
Drawn$ID <- 1:1000
# Create range of years over which the combined coefficient will be
# created
Range <- seq(from = 1821, to = 2008, by = 2)
# Multiply the time-varying coeff by time
TVSim <- outer(Drawn[, 1], Range)
TVSim <- data.frame(melt(TVSim))
TVSim <- rename(TVSim, c(X1 = "ID", X2 = "Time", value = "TVR"))
# Remove values outside of the 2.5% and 97.5% quantiles
# Find 2.5% and 97.5% quantiles for HRCC
TVSimPercECLBC <- ddply(TVSimECLBC, .(Time), transform, Lower = HRCC < quantile(HRCC, c(0.025)))
TVSimPercECLBC <- ddply(TVSimPercECLBC, .(Time), transform, Upper = HRCC > quantile(HRCC, c(0.975)))
# Remove variables outside of the middle 95%
TVSimPercECLBC <- subset(TVSimPercECLBC, Lower == FALSE & Upper == FALSE)
#### Create Combined Coefficient for EXEC = 1 & LBC = 1 ####
# Combine base variables
Drawn$Base <- Drawn[,2] + Drawn[,3] + Drawn[,4]
ECLBC <- Drawn[, c("ID", "Base")]
ECLBC$Fitted <- "Exec. Dom & Crisis"
# Add to time interaction to the base variables
TVSimECLBC <- merge(ECLBC, TVSim, by = "ID")
TVSimECLBC$CC <- TVSimECLBC$Base + TVSimECLBC$TVR
# Create Combined Hazard Ratio
TVSimECLBC$HRCC <- exp(TVSimECLBC$CC)
# Slim data set
TVSimECLBC <- TVSimECLBC[, c("ID", "Time", "HRCC", "Fitted")]
#### Create Combined Coefficient for EXEC = 1 & LBC = 0 ####
# Create new object with only executive_dom_fall
EC <- Drawn[, c("ID", "executive_dom_fall")]
EC$Fitted <- "Exec. Dom, No Crisis"
# Add to time interaction to the base variables
TVSimEC <- merge(EC, TVSim, by = "ID")
TVSimEC$CC <- TVSimEC$executive_dom_fall + TVSimEC$TVR
# Create Combined Hazard Ratio
TVSimEC$HRCC <- exp(TVSimEC$CC)
# Slim data set
TVSimEC <- TVSimEC[, c("ID", "Time", "HRCC", "Fitted")]
# Remove values outside of the 2.5% and 97.5% quantiles
# Find 2.5% and 97.5% quantiles for HRCC
TVSimPercEC <- ddply(TVSimEC, .(Time), transform, Lower = HRCC < quantile(HRCC, c(0.025)))
TVSimPercEC <- ddply(TVSimPercEC, .(Time), transform, Upper = HRCC > quantile(HRCC, c(0.975)))
# Remove variables outside of the middle 95%
TVSimPercEC <- subset(TVSimPercEC, Lower == FALSE & Upper == FALSE)
#### Append data sets ####
Graphable <- rbind(TVSimPercECLBC, TVSimPercEC)
# Order Variables
Graphable <- Graphable[order(Graphable$Time), ]
Graphable <- Graphable[order(Graphable$ID), ]
#### Graph Simulated Combined Hazard Ratios ####
# Create colour scale
ColourScale <- c("#1B9E77", "#E7298A")
# Plot
ggplot(Graphable, aes(x = Time, y = HRCC, colour = Fitted)) +
geom_point(shape = 21, alpha = I(0.06), size = 5) +
geom_smooth(method = "gam") +
scale_colour_manual(values = ColourScale, name = "") +
geom_hline(aes(yintercept = 1), linetype = "dotted", ) +
scale_y_continuous(limits = c(0, 4)) +
scale_x_continuous(breaks = c(0, 94), labels = c(1821, 2008)) +
xlab("") + ylab("Simulated Relative Hazard\n") +
theme_bw(base_size = 15)
ggplot(Graphable, aes(x = Time, y = HRCC, colour = Fitted)) +
geom_point(alpha = I(0.06)) +
geom_smooth(method = "gam") +
scale_colour_manual(values = ColourScale, name = "") +
geom_hline(aes(yintercept = 1), linetype = "dotted", ) +
scale_y_continuous(limits = c(0, 4)) +
scale_x_continuous(breaks = c(0, 94), labels = c(1821, 2008)) +
xlab("") + ylab("Simulated Relative Hazard\n") +
theme_bw(base_size = 15)
# Load required libraries
library(survival)
library(MSBVAR)
library(reshape)
library(reshape2)
library(ggplot2)
#Load Data
data1 <- read.csv("~/Desktop/JeffFall2012/jeffData.csv")
#Load Data
sub.ED_Dem_5 <- subset(CompleteData, BoixDemocracy==0)
# Run Cox PH Model
M6 <- coxph(Surv(begin, end, Partisan_Spell) ~
ED_TVC + BEGINbc*executive_dom_fall +
cumulative_crisis +  Growth +
periphery_LAm  +
frailty(imfcode),
data = sub.ED_Dem_5,
control = coxph.control(
eps = 1e-09, iter.max = 100, outer.max = 100))
summary(M6)
# Create coefficient matrix
Coef <- matrix(M6$coefficients)
# Create variance-covariance matrix
VC <- vcov(M6)
#### Simulate Using MSBVAR ####
Drawn <- rmultnorm(n = 1000, mu = Coef, vmat = VC)
# Keep qmv and Lqmv
Drawn <- data.frame(Drawn[, c(1, 3, 7)])
# Create Merge Variable (Simulation Number)
Drawn$ID <- 1:1000
# Create range of years over which the combined coefficient will be
# created
Range <- seq(from = 1821, to = 2008, by = 2)
# Multiply the time-varying coeff by time
TVSim <- outer(Drawn[, 1], Range)
TVSim <- data.frame(melt(TVSim))
TVSim <- rename(TVSim, c(X1 = "ID", X2 = "Time", value = "TVR"))
#### Create Combined Coefficient
# Combine base variables
Drawn$Base <- Drawn[,2] + Drawn[,3]
BaseData <- Drawn[, c("ID", "Base")]
# Add to time interaction to the base variables
TVSim <- merge(BaseData, TVSim, by = "ID")
TVSim$CC <- TVSim$Base + TVSim$TVR
# Create Combined Hazard Ratio
TVSim$HRCC <- exp(TVSim$CC)
# Order Variables
TVSim <- TVSim[order(TVSim$Time), ]
TVSim <- TVSim[order(TVSim$ID), ]
# Remove values outside of the 2.5% and 97.5% quantiles
# Find 2.5% and 97.5% quantiles for HRCC
TVSimPerc <- ddply(TVSim, .(Time), transform, Lower = HRCC < quantile(HRCC, c(0.025)))
TVSimPerc <- ddply(TVSimPerc, .(Time), transform, Upper = HRCC > quantile(HRCC, c(0.975)))
# Remove variables outside of the middle 95%
TVSimPerc <- subset(TVSimPerc, Lower == FALSE & Upper == FALSE)
TVSimPerc$year <- seq(from = 1821, to = 2008, by = 2)
ggplot(TVSimPerc, aes(x = year, y = HRCC)) +
geom_point(alpha = I(0.06) ,colour = "gray60") +
geom_smooth() +
geom_hline(aes(yintercept = 1), linetype = "dotted") +
scale_y_continuous(limits = c(0, 4)) +
scale_x_continuous(breaks = c(1821, 1840, 1860, 1880, 1900, 1920, 1940, 1960, 1980, 2000, 2007)) +
xlab("") + ylab("Simulated Relative Hazard\n") +
theme_bw(base_size = 15)
data1 <- read.csv("~/Desktop/JeffFall2012/jeffData.csv")
#Load Data
sub.ED_Dem_5 <- subset(CompleteData, BoixDemocracy==0)
# Run Cox PH Model
M6 <- coxph(Surv(begin, end, Partisan_Spell) ~
ED_TVC + BEGINbc*executive_dom_fall +
cumulative_crisis +  Growth +
periphery_LAm  +
frailty(imfcode),
data = sub.ED_Dem_5,
control = coxph.control(
eps = 1e-09, iter.max = 100, outer.max = 100))
summary(M6)
# Create coefficient matrix
Coef <- matrix(M6$coefficients)
# Create variance-covariance matrix
VC <- vcov(M6)
#### Simulate Using MSBVAR ####
Drawn <- rmultnorm(n = 1000, mu = Coef, vmat = VC)
# Keep qmv and Lqmv
Drawn <- data.frame(Drawn[, c(1, 3, 7)])
# Create Merge Variable (Simulation Number)
Drawn$ID <- 1:1000
# Create range of years over which the combined coefficient will be
# created
Range <- seq(from = 1821, to = 2008, by = 2)
# Multiply the time-varying coeff by time
TVSim <- outer(Drawn[, 1], Range)
TVSim <- data.frame(melt(TVSim))
TVSim <- rename(TVSim, c(X1 = "ID", X2 = "Time", value = "TVR"))
#### Create Combined Coefficient
# Combine base variables
Drawn$Base <- Drawn[,2] + Drawn[,3]
BaseData <- Drawn[, c("ID", "Base")]
# Add to time interaction to the base variables
TVSim <- merge(BaseData, TVSim, by = "ID")
TVSim$CC <- TVSim$Base + TVSim$TVR
# Create Combined Hazard Ratio
TVSim$HRCC <- exp(TVSim$CC)
# Order Variables
TVSim <- TVSim[order(TVSim$Time), ]
TVSim <- TVSim[order(TVSim$ID), ]
# Remove values outside of the 2.5% and 97.5% quantiles
# Find 2.5% and 97.5% quantiles for HRCC
TVSimPerc <- ddply(TVSim, .(Time), transform, Lower = HRCC < quantile(HRCC, c(0.025)))
TVSimPerc <- ddply(TVSimPerc, .(Time), transform, Upper = HRCC > quantile(HRCC, c(0.975)))
# Remove variables outside of the middle 95%
TVSimPerc <- subset(TVSimPerc, Lower == FALSE & Upper == FALSE)
data1 <- read.csv("~/Desktop/JeffFall2012/jeffData.csv")
#Load Data
sub.ED_Dem_5 <- subset(CompleteData, BoixDemocracy==0)
# Run Cox PH Model
M6 <- coxph(Surv(begin, end, Partisan_Spell) ~
ED_TVC + BEGINbc*executive_dom_fall +
cumulative_crisis +  Growth +
periphery_LAm  +
frailty(imfcode),
data = sub.ED_Dem_5,
control = coxph.control(
eps = 1e-09, iter.max = 100, outer.max = 100))
summary(M6)
# Create coefficient matrix
Coef <- matrix(M6$coefficients)
# Create variance-covariance matrix
VC <- vcov(M6)
#### Simulate Using MSBVAR ####
Drawn <- rmultnorm(n = 1000, mu = Coef, vmat = VC)
# Keep qmv and Lqmv
Drawn <- data.frame(Drawn[, c(1, 3, 7)])
# Create Merge Variable (Simulation Number)
Drawn$ID <- 1:1000
# Create range of years over which the combined coefficient will be
# created
Range <- seq(from = 1821, to = 2008, by = 2)
# Multiply the time-varying coeff by time
TVSim <- outer(Drawn[, 1], Range)
TVSim <- data.frame(melt(TVSim))
TVSim <- rename(TVSim, c(X1 = "ID", X2 = "Time", value = "TVR"))
#### Create Combined Coefficient
# Combine base variables
Drawn$Base <- Drawn[,2] + Drawn[,3]
BaseData <- Drawn[, c("ID", "Base")]
# Add to time interaction to the base variables
TVSim <- merge(BaseData, TVSim, by = "ID")
TVSim$CC <- TVSim$Base + TVSim$TVR
# Create Combined Hazard Ratio
TVSim$HRCC <- exp(TVSim$CC)
# Order Variables
TVSim <- TVSim[order(TVSim$Time), ]
TVSim <- TVSim[order(TVSim$ID), ]
# Remove values outside of the 2.5% and 97.5% quantiles
# Find 2.5% and 97.5% quantiles for HRCC
TVSimPerc <- ddply(TVSim, .(Time), transform, Lower = HRCC < quantile(HRCC, c(0.025)))
TVSimPerc <- ddply(TVSimPerc, .(Time), transform, Upper = HRCC > quantile(HRCC, c(0.975)))
# Remove variables outside of the middle 95%
TVSimPerc <- subset(TVSimPerc, Lower == FALSE & Upper == FALSE)
data1 <- read.csv("~/Desktop/JeffFall2012/jeffData.csv")
#Load Data
sub.ED_Dem_5 <- subset(CompleteData, BoixDemocracy==0)
data1 <- read.dta("https://dl.dropbox.com/u/20427285/PS_Data_CurrentNewTrade_No_Swiss.dta")
library(foreign)
data1 <- read.dta("https://dl.dropbox.com/u/20427285/PS_Data_CurrentNewTrade_No_Swiss.dta")
data1 <- read.dta("http://dl.dropbox.com/u/20427285/PS_Data_CurrentNewTrade_No_Swiss.dta")
vars <- c("begin", "end", "Partisan_Spell", "BEGINbc", "executive_dom_fall",
"cumulative_crisis", "polity2", "Growth", "periphery_LAm", "imfcode", "BoixDemocracy")
# Keep complete cases
CompleteData <- data1[complete.cases(data1[vars]),]
CompleteData <- CompleteData[vars]
# Create  interactions
CompleteData$ED_TVC <- CompleteData$executive_dom_fall * CompleteData$end
# Run Cox PH Model
M1 <- coxph(Surv(begin, end, Partisan_Spell) ~
ED_TVC + BEGINbc*executive_dom_fall +
cumulative_crisis + polity2 + Growth +
periphery_LAm  +
frailty(imfcode),
data = CompleteData,
control = coxph.control(
eps = 1e-09, iter.max = 100, outer.max = 100))
summary(M1)
Coef <- matrix(M1$coefficients)
# Create variance-covariance matrix
VC <- vcov(M1)
#### Simulate Using MSBVAR ####
Drawn <- rmultnorm(n = 1000, mu = Coef, vmat = VC)
# Keep qmv and Lqmv
Drawn <- data.frame(Drawn[, c(1, 3, 8)])
# Create Merge Variable (Simulation Number)
Drawn$ID <- 1:1000
# Create range of years over which the combined coefficient will be
# created
Range <- seq(from = 1821, to = 2008, by = 2)
# Multiply the time-varying coeff by time
TVSim <- outer(Drawn[, 1], Range)
TVSim <- data.frame(melt(TVSim))
TVSim <- rename(TVSim, c(X1 = "ID", X2 = "Time", value = "TVR"))
#### Create Combined Coefficient
# Combine base variables
Drawn$Base <- Drawn[,2] + Drawn[,3]
BaseData <- Drawn[, c("ID", "Base")]
# Add to time interaction to the base variables
TVSim <- merge(BaseData, TVSim, by = "ID")
TVSim$CC <- TVSim$Base + TVSim$TVR
# Create Combined Hazard Ratio
TVSim$HRCC <- exp(TVSim$CC)
# Order Variables
TVSim <- TVSim[order(TVSim$Time), ]
TVSim <- TVSim[order(TVSim$ID), ]
# Remove values outside of the 2.5% and 97.5% quantiles
# Find 2.5% and 97.5% quantiles for HRCC
TVSimPerc <- ddply(TVSim, .(Time), transform, Lower = HRCC < quantile(HRCC, c(0.025)))
TVSimPerc <- ddply(TVSimPerc, .(Time), transform, Upper = HRCC > quantile(HRCC, c(0.975)))
# Remove variables outside of the middle 95%
TVSimPerc <- subset(TVSimPerc, Lower == FALSE & Upper == FALSE)
TVSimPerc$year <- seq(from = 1821, to = 2008, by = 2)
#### Graph Simulated Combined Hazard Ratios ####
# Plot
ggplot(TVSimPerc, aes(x = Time, y = HRCC)) +
geom_point(alpha = I(0.06) ,colour = "gray60") +
geom_smooth() +
geom_hline(aes(yintercept = 1), linetype = "dotted") +
scale_y_continuous(limits = c(0, 4)) +
scale_x_continuous(breaks = c(0, 94), labels = c(1821, 2008)) +
xlab("") + ylab("Simulated Relative Hazard\n") +
theme_bw(base_size = 15)
ggplot(TVSimPerc, aes(x = year, y = HRCC)) +
geom_point(alpha = I(0.06) ,colour = "gray60") +
geom_smooth() +
geom_hline(aes(yintercept = 1), linetype = "dotted") +
scale_y_continuous(limits = c(0, 4)) +
scale_x_continuous(breaks = c(0, 94), labels = c(1821, 2008)) +
xlab("") + ylab("Simulated Relative Hazard\n") +
theme_bw(base_size = 15)
ggplot(TVSimPerc, aes(x = year, y = HRCC)) +
geom_point(alpha = I(0.06) ,colour = "gray60") +
geom_smooth() +
geom_hline(aes(yintercept = 1), linetype = "dotted") +
scale_y_continuous(limits = c(0, 4)) +
#scale_x_continuous(breaks = c(0, 94), labels = c(1821, 2008)) +
xlab("") + ylab("Simulated Relative Hazard\n") +
theme_bw(base_size = 15)
viewData(TVSimPerc)
viewData(TVSimPerc)
#Load Data
data1 <- read.dta("http://dl.dropbox.com/u/20427285/PS_Data_CurrentNewTrade_No_Swiss.dta")
#### Clean up base data set ####
# Keep only variables used in the model
vars <- c("begin", "end", "Partisan_Spell", "BEGINbc", "executive_dom_fall",
"cumulative_crisis", "polity2", "Growth", "periphery_LAm", "imfcode", "BoixDemocracy")
# Keep complete cases
CompleteData <- data1[complete.cases(data1[vars]),]
CompleteData <- CompleteData[vars]
# Create  interactions
CompleteData$ED_TVC <- CompleteData$executive_dom_fall * CompleteData$end
# Run Cox PH Model
M1 <- coxph(Surv(begin, end, Partisan_Spell) ~
ED_TVC + BEGINbc*executive_dom_fall +
cumulative_crisis + polity2 + Growth +
periphery_LAm  +
frailty(imfcode),
data = CompleteData,
control = coxph.control(
eps = 1e-09, iter.max = 100, outer.max = 100))
summary(M1)
# Create coefficient matrix
Coef <- matrix(M1$coefficients)
# Create variance-covariance matrix
VC <- vcov(M1)
#### Simulate Using MSBVAR ####
Drawn <- rmultnorm(n = 1000, mu = Coef, vmat = VC)
# Keep qmv and Lqmv
Drawn <- data.frame(Drawn[, c(1, 3, 8)])
# Create Merge Variable (Simulation Number)
Drawn$ID <- 1:1000
# Create range of years over which the combined coefficient will be
# created
Range <- seq(from = 1821, to = 2008, by = 2)
# Multiply the time-varying coeff by time
TVSim <- outer(Drawn[, 1], Range)
TVSim <- data.frame(melt(TVSim))
TVSim <- rename(TVSim, c(X1 = "ID", X2 = "Time", value = "TVR"))
#### Create Combined Coefficient
# Combine base variables
Drawn$Base <- Drawn[,2] + Drawn[,3]
BaseData <- Drawn[, c("ID", "Base")]
# Add to time interaction to the base variables
TVSim <- merge(BaseData, TVSim, by = "ID")
TVSim$CC <- TVSim$Base + TVSim$TVR
# Create Combined Hazard Ratio
TVSim$HRCC <- exp(TVSim$CC)
# Order Variables
TVSim <- TVSim[order(TVSim$Time), ]
TVSim <- TVSim[order(TVSim$ID), ]
# Remove values outside of the 2.5% and 97.5% quantiles
# Find 2.5% and 97.5% quantiles for HRCC
TVSimPerc <- ddply(TVSim, .(Time), transform, Lower = HRCC < quantile(HRCC, c(0.025)))
TVSimPerc <- ddply(TVSimPerc, .(Time), transform, Upper = HRCC > quantile(HRCC, c(0.975)))
# Remove variables outside of the middle 95%
TVSimPerc <- subset(TVSimPerc, Lower == FALSE & Upper == FALSE)
TVSimPerc <- TVSimPerc[order(TVSimPerc$Time), ]
TVSimPerc <- TVSimPerc[order(TVSimPerc$ID), ]
TVSimPerc$year <- seq(from = 1821, to = 2008, by = 2)
viewData(TVSimPerc)
TVSimPerc$year <- seq(from = 1821, to = 2008, by = 2)
#### Graph Simulated Combined Hazard Ratios ####
# Plot
ggplot(TVSimPerc, aes(x = year, y = HRCC)) +
geom_point(alpha = I(0.06) ,colour = "gray60") +
geom_smooth() +
geom_hline(aes(yintercept = 1), linetype = "dotted") +
scale_y_continuous(limits = c(0, 4)) +
#scale_x_continuous(breaks = c(0, 94), labels = c(1821, 2008)) +
xlab("") + ylab("Simulated Relative Hazard\n") +
theme_bw(base_size = 15)
viewData(TVSimPerc)
ggplot(TVSimPerc, aes(x = year, y = HRCC)) +
geom_point(alpha = I(0.06) ,colour = "gray60") +
geom_smooth() +
geom_hline(aes(yintercept = 1), linetype = "dotted") +
scale_y_continuous(limits = c(0, 4)) +
scale_x_continuous(breaks = c(1, 10.5, 20.5, 30.5, 40.5, 50.5, 60.5, 70.5, 80.5 94),
labels = c(1821, 1840, 1860, 1880, 1900, 1920, 1940, 1960, 1980, 2000  2007)) +
xlab("") + ylab("Simulated Relative Hazard\n") +
theme_bw(base_size = 15)
ggplot(TVSimPerc, aes(x = year, y = HRCC)) +
geom_point(alpha = I(0.06) ,colour = "gray60") +
geom_smooth() +
geom_hline(aes(yintercept = 1), linetype = "dotted") +
scale_y_continuous(limits = c(0, 4)) +
scale_x_continuous(breaks = c(1, 10.5, 20.5, 30.5, 40.5, 50.5, 60.5, 70.5, 80.5 94),
labels = c(1821, 1840, 1860, 1880, 1900, 1920, 1940, 1960, 1980, 2000,  2007)) +
xlab("") + ylab("Simulated Relative Hazard\n") +
theme_bw(base_size = 15)
ggplot(TVSimPerc, aes(x = year, y = HRCC)) +
geom_point(alpha = I(0.06) ,colour = "gray60") +
geom_smooth() +
geom_hline(aes(yintercept = 1), linetype = "dotted") +
scale_y_continuous(limits = c(0, 4)) +
scale_x_continuous(breaks = c(1, 10.5, 20.5, 30.5, 40.5, 50.5, 60.5, 70.5, 80.5, 94),
labels = c(1821, 1840, 1860, 1880, 1900, 1920, 1940, 1960, 1980, 2000,  2007)) +
xlab("") + ylab("Simulated Relative Hazard\n") +
theme_bw(base_size = 15)
ggplot(TVSimPerc, aes(x = year, y = HRCC)) +
geom_point(alpha = I(0.06) ,colour = "gray60") +
geom_smooth() +
geom_hline(aes(yintercept = 1), linetype = "dotted") +
scale_y_continuous(limits = c(0, 4)) +
scale_x_continuous(breaks = c(1, 10.5, 20.5, 30.5, 40.5, 50.5, 60.5, 70.5, 80.5, 90.5, 94),
labels = c(1821, 1840, 1860, 1880, 1900, 1920, 1940, 1960, 1980, 2000,  2007)) +
xlab("") + ylab("Simulated Relative Hazard\n") +
theme_bw(base_size = 15)
ggplot(TVSimPerc, aes(x = Time, y = HRCC)) +
geom_point(alpha = I(0.06) ,colour = "gray60") +
geom_smooth() +
geom_hline(aes(yintercept = 1), linetype = "dotted") +
scale_y_continuous(limits = c(0, 4)) +
scale_x_continuous(breaks = c(1, 10.5, 20.5, 30.5, 40.5, 50.5, 60.5, 70.5, 80.5, 90.5, 94),
labels = c(1821, 1840, 1860, 1880, 1900, 1920, 1940, 1960, 1980, 2000,  2007)) +
xlab("") + ylab("Simulated Relative Hazard\n") +
theme_bw(base_size = 15)
ggplot(TVSimPerc, aes(x = Time, y = HRCC)) +
geom_point(alpha = I(0.06) ,colour = "gray60") +
geom_smooth() +
geom_hline(aes(yintercept = 1), linetype = "dotted") +
scale_y_continuous(limits = c(0, 4)) +
scale_x_continuous(breaks = c(1, 10.5, 20.5, 30.5, 40.5, 50.5, 60.5, 70.5, 80.5, 90.5),
labels = c(1821, 1840, 1860, 1880, 1900, 1920, 1940, 1960, 1980, 2000)) +
xlab("") + ylab("Simulated Relative Hazard\n") +
theme_bw(base_size = 15)
