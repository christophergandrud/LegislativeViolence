library(foreign)
Data <- read.dta("/git_repositories/LegislativeViolence/Data/leg_violence_main.dta")
write.csv("/git_repositories/LegislativeViolence/Data/LegViolenceMain.csv")
write.csv(Data, "/git_repositories/LegislativeViolence/Data/LegViolenceMain.csv")
Data <- read.dta("/git_repositories/LegislativeViolence/Data/leg_violence_descriptives.dta")
write.csv(Data, "/git_repositories/LegislativeViolence/Data/LegViolenceDescriptives.csv")
write.csv(Data, "/git_repositories/LegislativeViolence/Data/LegViolenceDescriptives.csv", row.names = FALSE)
write.csv(Data, "/git_repositories/LegislativeViolence/Data/LegViolenceMain.csv", row.names = FALSE)
Data <- read.dta("/git_repositories/LegislativeViolence/Data/leg_violence_main.dta")
Data <- read.dta("/git_repositories/LegislativeViolence/Data/Origninal/leg_violence_main.dta")
write.csv(Data, "/git_repositories/LegislativeViolence/Data/LegViolenceMain.csv", row.names = FALSE)
library(RCurl)
URLDescript <- "https://raw.github.com/christophergandrud/LegislativeViolence/master/Data/LegViolenceDescriptives.csv"
Descript <- getURL(URLDescript)
leg.cumulative <- read.csv(textConnection(Descript))
leg.cumulative$violence <- factor(leg.cumulative$violence, label = c("No Violence", "Violence"))
leg.cumulative <- subset(leg.cumulative, violence != "NA")
leg.cumulative <- subset (leg.cumulative, year > 1980)
cols <- c("1" = "#EDDD00", "2" = "#ED6700", "3" = "#A04400", "0" = "#5E5E5E")
age.dem.scatter <- qplot(dem_age, udems_mean, position = position_jitter(w = 10), color = factor(violence_y_cum), data = leg.cumulative) +
facet_grid(.~violence) +
xlab("\n Age of Democracy") +
ylab("Unified Democracy Score") +
theme_bw() +
scale_colour_manual(values = cols, name = "Brawl/Year") +
opts(axis.title.x = theme_text(size = 12, vjust = 0))
print(age.dem.scatter)
library(ggplot2)
age.dem.scatter <- qplot(dem_age, udems_mean, position = position_jitter(w = 10), color = factor(violence_y_cum), data = leg.cumulative) +
facet_grid(.~violence) +
xlab("\n Age of Democracy") +
ylab("Unified Democracy Score") +
theme_bw(base_size = 12) +
scale_colour_manual(values = cols, name = "Brawl/Year")
print(age.dem.scatter)
URLMain <- "https://raw.github.com/christophergandrud/LegislativeViolence/master/Data/LegViolenceMain.csv"
Main <- getURL(URLMain)
leg.raw <- read.csv(textConnection(Main))
## Keep variables of interest
vars <- c("country", "year", "violence", "system", "DemAge", "maj", "MajCat", "govfrac", "singleParty", "pr", "tenshort", "UDS", "polity2", "ethnicAlesina", "CWtrust", "higherTrust", "CWsurvSelfExpr", "legislature", "elect_legislature", "disproportionality", "gini", "GDPperCapita", "enps", "enpv", "federal", "immunity")
leg.raw <- leg.raw[vars]
## Label MajCat factor categories
leg.raw$MajCat <- factor(leg.raw$MajCat, labels = c("Minority", "Regular Maj.", "Strong Maj."))
## Transform GDP/capita to thousands of USD
leg.raw$GDPperCapita <- leg.raw$GDPperCapita/1000
## Create disproportionality threshold variable where 1 < 5
leg.raw$HighProp[leg.raw$disproportionality < 5] <- 1
leg.raw$HighProp[leg.raw$disproportionality >= 5] <- 0
## Transform majority variable from a proportion to a percentage
leg.raw$maj = leg.raw$maj*100
## Only Countries with Legislatures
leg <- subset(leg.raw, legislature == 1)
## Only Countries with Elected Legislatures
dem <- subset(leg.raw, elect_legislature == 1)
## Only Countries with Elected Legislatures after 1989 (new sample 199)
dNew <- subset(dem, year > 1989)
library(devtools)
source_url("https://raw.github.com/christophergandrud/LegislativeViolence/master/Analysis/leg.main.analyses2.R")
source_url("https://raw.github.com/christophergandrud/LegislativeViolence/master/Analysis/expectedValueGraphs2.R")
source_url("https://raw.github.com/christophergandrud/LegislativeViolence/master/Analysis/boxPlots.R")
source_url("https://raw.github.com/christophergandrud/LegislativeViolence/master/Analysis/FrameworkEmpirical.R")
D15.demAge.p <- ggplot(D15.demAge.e, aes(variable, value)) +
geom_point(shape = 21, color = "gray30", alpha = I(0.05)) +
stat_smooth() +
scale_x_continuous(breaks = c(0, 21, 51, 85), labels = c("0", "20", "50", "85")) +
scale_y_continuous(breaks = c(0, 0.02, 0.05, 0.1, 0.15), limits = c(0, 0.15)) +
xlab("\nAge of Democracy") + ylab("") +
theme_bw(base_size = 12)
ggplot(D15.demAge.e, aes(variable, value)) +
geom_point(shape = 21, color = "gray30", alpha = I(0.05)) +
stat_smooth() +
scale_x_continuous(breaks = c(0, 21, 51, 85), labels = c("0", "20", "50", "85")) +
scale_y_continuous(breaks = c(0, 0.02, 0.05, 0.1, 0.15), limits = c(0, 0.15)) +
xlab("\nAge of Democracy") + ylab("") +
theme_bw(base_size = 12)
D15.demAge.ePer <- ddply(D15.demAge.e, .(variable), transform, Lower = value < quantile(value, c(0.025)))
library(plyr)
D15.demAge.ePer <- ddply(D15.demAge.e, .(variable), transform, Lower = value < quantile(value, c(0.025)))
D15.demAge.ePer <- ddply(D15.demAge.ePer, .(variable), transform, Upper = value > quantile(value, c(0.975)))
# Remove variables outside of the middle 95%
D15.demAge.ePer <- subset(D15.demAge.ePer, Lower == FALSE & Upper == FALSE)
ggplot(D15.demAge.ePer, aes(variable, value)) +
geom_point(shape = 21, color = "gray30", alpha = I(0.05)) +
stat_smooth() +
scale_x_continuous(breaks = c(0, 21, 51, 85), labels = c("0", "20", "50", "85")) +
scale_y_continuous(breaks = c(0, 0.02, 0.05, 0.1, 0.15), limits = c(0, 0.15)) +
xlab("\nAge of Democracy") + ylab("") +
theme_bw(base_size = 12)
ggplot(D15.HighProp.e, aes(variable, value)) +
geom_point(shape = 21, color = "gray30", alpha = I(0.05)) +
stat_smooth(method = "lm", se = FALSE) +
scale_x_reverse(breaks = c(1, 2), labels = c("Higher", "Very Low")) +
scale_y_continuous(breaks = c(0, 0.02, 0.05, 0.1, 0.15), labels = c("", "", "", "", ""), limits = c(0, 0.15)) +
xlab("\nDisproportionality") + ylab("") +
theme_bw(base_size = 12)
D15.HighProp.ePer <- ddply(D15.HighProp.e, .(variable), transform,
Lower = value < quantile(value, c(0.025)))
D15.HighProp.ePer <- ddply(D15.HighProp.ePer, .(variable), transform,
Upper = value > quantile(value, c(0.975)))
# Remove variables outside of the middle 95%
D15.HighProp.ePer <- subset(D15.HighProp.ePer, Lower == FALSE & Upper == FALSE)
ggplot(D15.HighProp.ePer, aes(variable, value)) +
geom_point(shape = 21, color = "gray30", alpha = I(0.05)) +
stat_smooth(method = "lm", se = FALSE) +
scale_x_reverse(breaks = c(1, 2), labels = c("Higher", "Very Low")) +
scale_y_continuous(breaks = c(0, 0.02, 0.05, 0.1, 0.15),
labels = c("", "", "", "", ""), limits = c(0, 0.15)) +
xlab("\nDisproportionality") + ylab("") +
theme_bw(base_size = 12)
ggplot(D15.maj.e, aes(variable, value)) +
geom_point(shape = 21, color = "gray30", alpha = I(0.05)) +
stat_smooth(method = "lm", se = FALSE) +
scale_y_continuous(breaks = c(0, 0.02, 0.05, 0.1, 0.15),
labels = c("", "", "", "", ""),
limits = c(0, 0.15)) +
xlab("\nGovernment Majority") + ylab("") +
theme_bw()
# Find 2.5% and 97.5% quantiles for HRCC
D15.maj.ePer <- ddply(D15.maj.e, .(variable), transform,
Lower = value < quantile(value, c(0.025)))
D15.maj.ePer <- ddply(D15.maj.ePer, .(variable), transform,
Upper = value > quantile(value, c(0.975)))
# Remove variables outside of the middle 95%
D15.maj.ePer <- subset(D15.maj.ePer, Lower == FALSE & Upper == FALSE)
# Plot
D15.maj.p <- ggplot(D15.maj.ePer, aes(variable, value)) +
geom_point(shape = 21, color = "gray30", alpha = I(0.05)) +
stat_smooth(method = "lm", se = FALSE) +
scale_y_continuous(breaks = c(0, 0.02, 0.05, 0.1, 0.15),
labels = c("", "", "", "", ""),
limits = c(0, 0.15)) +
xlab("\nGovernment Majority") + ylab("") +
theme_bw()
D15.maj.p
